---

title: field_on_grid


keywords: fastai
sidebar: home_sidebar

summary: "A class to handle a field on a 3-dimensional grid for a Fast-Fourier-Transformation (FFT) calculation."
description: "A class to handle a field on a 3-dimensional grid for a Fast-Fourier-Transformation (FFT) calculation."
nb_path: "field_on_grid.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: field_on_grid.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Field_on_grid" class="doc_header"><code>class</code> <code>Field_on_grid</code><a href="https://github.com/{saitosmst}/two_point_clustering/tree/{branch}/two_point_clustering/field_on_grid.py#L15" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Field_on_grid</code>(<strong><code>Lbox</code></strong>, <strong><code>Ngrid</code></strong>, <strong><code>do_cube</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>A class to handle a field on a 3-dimensional grid.</p>
<p>FFT convention relies on scipy.fftpack.fftn
For the convention, see:
  <a href="https://docs.scipy.org/doc/scipy-0.19.0/reference/generated/scipy.fftpack.fft.html">https://docs.scipy.org/doc/scipy-0.19.0/reference/generated/scipy.fftpack.fft.html</a></p>
<h2 id="Attributes">Attributes<a class="anchor-link" href="#Attributes"> </a></h2><p>Lbox_sim: array_like(shape=(3,))
          The box size which an user specifies.</p>
<p>Ngrid: integer
       Number of grids along the axis with maximum length.</p>
<p>do_cube: logical
         If True, set a FFT box with a uniform length.</p>
<p>Lmax: float
      The maximum value of Lbox_sim.</p>
<p>Lgrid: float
       Length size of each grid. Set as Lmax/Ngrid, i.e., same for all directions.</p>
<p>Vgrid: float
       Volume size of each grid.</p>
<p>k_nyq: float
       Nyquist wavenumber = pi/Lgrid</p>
<p>k_smp: float
       Sampling wavenumber = 2*pi/Lgrid</p>
<p>Lbox_fft: array_like(shape=(3,))
          The FFT box size which an user specifies. If do_cube is True, Lbox_fft[:] = Lmax.</p>
<p>k_f: array_like(shape=(3,))
     fundamental frequency = 2*pi/Lbox_fft</p>
<p>Vbox_sim: float
          Volume size of the original box.</p>
<p>Vbox_fft: float
          Volume size of the FFT box.</p>
<p>nx, ny, nz: integer
            number of grid along each axis.</p>
<p>ix_c, iy_c, iz_c: numpy mgrid[nx, ny, nz]
                  index of grid in configuration space.</p>
<p>c_grid: numpy mgrid[nx, ny, nz]
        length of each grid from the origin in configuration space.</p>
<p>ix_k, iy_k, iz_k: numpy mgrid[nx, ny, nz]
                  index of grid in Fourier space.</p>
<p>k_grid: numpy mgrid[nx, ny, nz]
        length of each grid from the origin in Fourier space.</p>
<h2 id="Methods">Methods<a class="anchor-link" href="#Methods"> </a></h2><p>set_muk_grid: set mu_k at a fixed LOS direction.</p>
<p>calc_iFFT: inverse FFT operation (configuration to Fourier space)</p>
<p>calc_FFT: FFT operation (Fourier to configuration space)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;running test...&#39;</span><span class="p">)</span>
<span class="n">fg</span> <span class="o">=</span> <span class="n">Field_on_grid</span><span class="p">(</span><span class="n">Lbox</span><span class="o">=</span><span class="p">[</span><span class="mf">1000.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">],</span> <span class="n">Ngrid</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Nyquist wavenumber k_ny = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">k_nyq</span><span class="p">))</span>
<span class="n">arr_const_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">nz</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">arr_const_c</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">arr_const_k</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">calc_iFFT</span><span class="p">(</span><span class="n">arr_const_c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Compare (iFFT of unity)=</span><span class="si">{0}</span><span class="s1"> vs (Lgrid*Ngrid)^3=</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arr_const_k</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fg</span><span class="o">.</span><span class="n">Lgrid</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">fg</span><span class="o">.</span><span class="n">Ngrid</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>running test...
  Nyquist wavenumber k_ny = 0.8042477193189871
  Compare (iFFT of unity)=(1000000000+0j) vs (Lgrid*Ngrid)^3=1000000000.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

